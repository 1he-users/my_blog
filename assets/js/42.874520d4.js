(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{263:function(e,o,_){"use strict";_.r(o);var v=_(0),t=Object(v.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,o=e.$createElement,_=e._self._c||o;return _("div",{staticClass:"content"},[_("h1",{attrs:{id:"_011-对-cookie-了解多少？"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_011-对-cookie-了解多少？","aria-hidden":"true"}},[e._v("#")]),e._v(" 011: 对 Cookie 了解多少？")]),e._v(" "),_("h2",{attrs:{id:"cookie-简介"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#cookie-简介","aria-hidden":"true"}},[e._v("#")]),e._v(" Cookie 简介")]),e._v(" "),_("p",[e._v("前面说到了 HTTP 是一个无状态的协议，每次 http 请求都是独立、无关的，默认不需要保留状态信息。但有时候需要保存一些状态，怎么办呢？")]),e._v(" "),_("p",[e._v("HTTP 为此引入了 Cookie。Cookie 本质上就是浏览器里面存储的一个很小的文本文件，内部以键值对的方式来存储(在chrome开发者面板的Application这一栏可以看到)。向同一个域名下发送请求，都会携带相同的 Cookie，服务器拿到 Cookie 进行解析，便能拿到客户端的状态。而服务端可以通过响应头中的"),_("code",[e._v("Set-Cookie")]),e._v("字段来对客户端写入"),_("code",[e._v("Cookie")]),e._v("。举例如下:")]),e._v(" "),_("div",{staticClass:"language- extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[e._v("// 请求头\nCookie: a=xxx;b=xxx\n// 响应头\nSet-Cookie: a=xxx\nset-Cookie: b=xxx\n")])])]),_("h2",{attrs:{id:"cookie-属性"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#cookie-属性","aria-hidden":"true"}},[e._v("#")]),e._v(" Cookie 属性")]),e._v(" "),_("h3",{attrs:{id:"生存周期"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#生存周期","aria-hidden":"true"}},[e._v("#")]),e._v(" 生存周期")]),e._v(" "),_("p",[e._v("Cookie 的有效期可以通过"),_("strong",[e._v("Expires")]),e._v("和"),_("strong",[e._v("Max-Age")]),e._v("两个属性来设置。")]),e._v(" "),_("ul",[_("li",[_("strong",[e._v("Expires")]),e._v("即"),_("code",[e._v("过期时间")])]),e._v(" "),_("li",[_("strong",[e._v("Max-Age")]),e._v("用的是一段时间间隔，单位是秒，从浏览器收到报文开始计算。")])]),e._v(" "),_("p",[e._v("若 Cookie 过期，则这个 Cookie 会被删除，并不会发送给服务端。")]),e._v(" "),_("h3",{attrs:{id:"作用域"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#作用域","aria-hidden":"true"}},[e._v("#")]),e._v(" 作用域")]),e._v(" "),_("p",[e._v("关于作用域也有两个属性: "),_("strong",[e._v("Domain")]),e._v("和"),_("strong",[e._v("path")]),e._v(", 给 "),_("strong",[e._v("Cookie")]),e._v(" 绑定了域名和路径，在发送请求之前，发现域名或者路径和这两个属性不匹配，那么就不会带上 Cookie。值得注意的是，对于路径来说，"),_("code",[e._v("/")]),e._v("表示域名下的任意路径都允许使用 Cookie。")]),e._v(" "),_("h3",{attrs:{id:"安全相关"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#安全相关","aria-hidden":"true"}},[e._v("#")]),e._v(" 安全相关")]),e._v(" "),_("p",[e._v("如果 cookie 字段带上"),_("code",[e._v("HttpOnly")]),e._v("，那么说明只能通过 HTTP 协议传输，不能通过 JS 访问，这也是预防 XSS 攻击的重要手段。")]),e._v(" "),_("p",[e._v("相应的，对于 CSRF 攻击的预防，也有"),_("code",[e._v("SameSite")]),e._v("属性。")]),e._v(" "),_("p",[_("code",[e._v("SameSite")]),e._v("可以设置为三个值，"),_("code",[e._v("Strict")]),e._v("、"),_("code",[e._v("Lax")]),e._v("和"),_("code",[e._v("None")]),e._v("。")]),e._v(" "),_("p",[_("strong",[e._v("a.")]),e._v(" 在"),_("code",[e._v("Strict")]),e._v("模式下，浏览器完全禁止第三方请求携带Cookie。比如请求"),_("code",[e._v("sanyuan.com")]),e._v("网站只能在"),_("code",[e._v("sanyuan.com")]),e._v("域名当中请求才能携带 Cookie，在其他网站请求都不能。")]),e._v(" "),_("p",[_("strong",[e._v("b.")]),e._v(" 在"),_("code",[e._v("Lax")]),e._v("模式，就宽松一点了，但是只能在 "),_("code",[e._v("get 方法提交表单")]),e._v("况或者"),_("code",[e._v("a 标签发送 get 请求")]),e._v("的情况下可以携带 Cookie，其他情况均不能。")]),e._v(" "),_("p",[_("strong",[e._v("c.")]),e._v(" 在"),_("code",[e._v("None")]),e._v("模式下，也就是默认模式，请求会自动携带上 Cookie。")]),e._v(" "),_("h2",{attrs:{id:"cookie-的缺点"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#cookie-的缺点","aria-hidden":"true"}},[e._v("#")]),e._v(" Cookie 的缺点")]),e._v(" "),_("ol",[_("li",[_("p",[e._v("容量缺陷。Cookie 的体积上限只有"),_("code",[e._v("4KB")]),e._v("，只能用来存储少量的信息。")])]),e._v(" "),_("li",[_("p",[e._v("性能缺陷。Cookie 紧跟域名，不管域名下面的某一个地址需不需要这个 Cookie ，请求都会携带上完整的 Cookie，这样随着请求数的增多，其实会造成巨大的性能浪费的，因为请求携带了很多不必要的内容。但可以通过"),_("code",[e._v("Domain")]),e._v("和"),_("code",[e._v("Path")]),e._v("指定"),_("strong",[e._v("作用域")]),e._v("来解决。")])]),e._v(" "),_("li",[_("p",[e._v("安全缺陷。由于 Cookie 以纯文本的形式在浏览器和服务器中传递，很容易被非法用户截获，然后进行一系列的篡改，在 Cookie 的有效期内重新发送给服务器，这是相当危险的。另外，在"),_("code",[e._v("HttpOnly")]),e._v("为 false 的情况下，Cookie 信息能直接通过 JS 脚本来读取。")])])])])}],!1,null,null,null);o.default=t.exports}}]);